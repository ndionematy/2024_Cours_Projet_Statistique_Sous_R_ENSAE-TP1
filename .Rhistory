knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(readxl)
projet = read_xlsx("..//Donnees//Base_Projet.xlsx")
class(projet)
str(projet)
dim(projet)
sum(is.na(projet$key))
cat("\\fontsize{9}{11}\\selectfont")
projet = projet|>expss::apply_labels(
q1 = "Région",
q2 = "Département",
q23 = "Sexe du dirigeant/responsable de la PME",
q24 = "Age du dirigeant/responsable de la PME",
q24a_1 = "français", q24a_2 = "wolof",q24a_3 = "Diola",
q24a_4 = "Serere", q24a_5 = "Peul",
q24a_6 = "Mandingue", q24a_7 = "Balante",
q24a_9 = "Bambara", q24a_10 = "Autres langues",
q25 = "Niveau d’instruction",
q26 = "Nombre d’années d’experience professionnelle dans l’entreprise",
q12 = "Statut juridique",
q14b = "Autorisation de fabrication et de mise en vente (FRA)",
q16 = "L’entreprise est-elle désservie par une route bitumée ?",
q17 = "Etat de la route bitumée",
q19 = "Etat de la piste qui mène à l’entreprise",
q20 = "Avez-vous des associés dans l’entreprise",filiere_1 = "arachide",
filiere_2 = "anacarde", filiere_3 = "mangue", filiere_4 = "riz",
q8 = "Activité principale", q81 = "Propriétaire ou locataire",
gps_menlatitude = "Latitude", gps_menlongitude = "Longitude",
start = "Date de début de l'enregistrement", today = "Date de l'enquête")
library(dplyr)
projet = projet |> rename(region = q1,
departement = q2,
sexe = q23)
projet |> mutate(sexe_2 = case_when(sexe == "Femme" ~ 1,
sexe != "Femme" ~ 0))
projet = projet |> mutate(sexe_2 = case_when(sexe == "Femme" ~ 1,
sexe != "Femme" ~ 0))
table(projet$sexe_2)
191+59
projet$sexe_2
table(projet$sexe)
is.factor(projet$sexe_2)
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1': "Femme", '0': "Homme")
projet = projet |> mutate(sexe_2 = case_when(sexe == "Femme" ~ 1,
sexe != "Femme" ~ 0))
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1': "Femme", '0': "Homme")
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
table(projet$sexe_2)
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
# table(projet$sexe_2)
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
# table(projet$sexe_2)
projet |> select("key")
# projet |> select("key")
projet |> select(starts_with("q24a_"))
langues = data.frame(projet |> select("key"), select(starts_with("q24a_")))
langues = data.frame(projet |> select("key"), projet |>select(starts_with("q24a_")))
View(langues)
langues = data.frame(projet |> select("key"), projet |>select(starts_with("q24a_")))
lvars = c("q24a_1","q24a_2","q24a_3","q24a_4","q24a_5",
"q24a_6","q24a_7","q24a_9","q24a_10")
langues = langues |> mutate(parle = sum(lvars))
View(projet)
View(langues)
lvars = c("q24a_1","q24a_2","q24a_3","q24a_4","q24a_5",
"q24a_6","q24a_7","q24a_9","q24a_10")
langues = langues |> mutate(parle = sum(q24a_1,q24a_2))
lvars = c("q24a_1","q24a_2","q24a_3","q24a_4","q24a_5",
"q24a_6","q24a_7","q24a_9","q24a_10")
langues = langues |> mutate(parle = q24a_1+q24a_2)
langues = langues |> mutate(parle = q24a_1 + q24a_2 +
q24a_3 + q24a_4 + q24a_5 +
q24a_6 + q24a_7 + q24a_9 +
q24a_10)
langue = langues |> mutate(parle = rowSums(select(., starts_with("q24a_"))))
langue = langues |> mutate(parle = rowSums(select(starts_with("q24a_"))))
langue = langues |> mutate(parle = rowSums(select(., starts_with("q24a_"))))
langue = langues |> mutate(parle = rowSums(select(langues, starts_with("q24a_"))))
langues = langues |> mutate(parler = rowSums(select(langues, starts_with("q24a_"))))
langues = langues |> mutate(parle = rowSums(select(langues, starts_with("q24a_"))))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(readxl)
projet = read_xlsx("..//Donnees//Base_Projet.xlsx")
class(projet)
str(projet)
dim(projet)
sum(is.na(projet$key))
cat("\\fontsize{9}{11}\\selectfont")
projet = projet|>expss::apply_labels(
q1 = "Région",
q2 = "Département",
q23 = "Sexe du dirigeant/responsable de la PME",
q24 = "Age du dirigeant/responsable de la PME",
q24a_1 = "français", q24a_2 = "wolof",q24a_3 = "Diola",
q24a_4 = "Serere", q24a_5 = "Peul",
q24a_6 = "Mandingue", q24a_7 = "Balante",
q24a_9 = "Bambara", q24a_10 = "Autres langues",
q25 = "Niveau d’instruction",
q26 = "Nombre d’années d’experience professionnelle dans l’entreprise",
q12 = "Statut juridique",
q14b = "Autorisation de fabrication et de mise en vente (FRA)",
q16 = "L’entreprise est-elle désservie par une route bitumée ?",
q17 = "Etat de la route bitumée",
q19 = "Etat de la piste qui mène à l’entreprise",
q20 = "Avez-vous des associés dans l’entreprise",filiere_1 = "arachide",
filiere_2 = "anacarde", filiere_3 = "mangue", filiere_4 = "riz",
q8 = "Activité principale", q81 = "Propriétaire ou locataire",
gps_menlatitude = "Latitude", gps_menlongitude = "Longitude",
start = "Date de début de l'enregistrement", today = "Date de l'enquête")
library(dplyr)
projet = projet |> rename(region = q1,
departement = q2,
sexe = q23)
projet = projet |> mutate(sexe_2 = case_when(sexe == "Femme" ~ 1,
sexe != "Femme" ~ 0))
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
# table(projet$sexe_2)
langues = data.frame(projet |> select("key"), projet |> select(starts_with("q24a_")))
langues = langues |> mutate(parle = rowSums(select(langues, starts_with("q24a_"))))
langues = langues |> select("key","parle")
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
table(projet$sexe_2)
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
# table(projet$sexe_2)
inner_join(projet,langues, join_by(projet$key=langues$key))
inner_join(projet,langues, join_by(projet$key==langues$key))
inner_join(x=projet,y=langues, join_by(x$key==y$key))
df = inner_join(x=projet,y=langues, join_by(x$key==y$key))
table(df$sexe_2)
table(df$sexe_2)
table(df$q25)
pie(table(df$sexe_2))
table(df$q25)
pie(table(df$sexe_2))
hist(table(df$q25))
pie(table(df$sexe_2))
barplot(table(df$q25))
table(df$q25)
choisir_option <- function(options) {
choix <- select.list(choices = options,
title = "Choisissez une option :")
return(choix)
}
choisir_option <- function() {
options <- c("Option 1", "Option 2", "Option 3")
choix <- select.list(choices = options,
title = "Choisissez une option :")
cat("L'utilisateur a choisi l'option :", choix)
}
choisir_option()
source("..//Scripts//app.R")
source("..//Scripts//app.R")
shiny::runApp('Scripts')
pie(table(df$sexe_2))
barplot(table(df$q25))
pie(table(df$q12))
pie(table(df$sexe_2))
barplot(table(df$q25))
barplot(table(df$q12))
View(df)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(table(df$q81))
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(table(df$q81))
table(df$q12, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(table(df$q81))
prop.table(df$q12, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(table(df$q81))
table(df$q12, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(table(df$q81))
prop.table(table(df$q12, df$sexe))
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
table(df$q25, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
barplot(df$q25, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
table(df$q25, df$sexe)
table(df$q81, df$sexe)
table(df$q25)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
barplot(table(df$q25, df$sexe), beside=TRUE, levels=df$sexe)
table(df$q81, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
barplot(table(df$sexe, df$q25), beside=TRUE, levels=df$sexe)
table(df$q81, df$sexe)
pie(table(df$sexe))
barplot(table(df$q25))
barplot(table(df$q12))
pie(prop.table(table(df$q81)))
table(df$q12, df$sexe)
barplot(table(df$sexe, df$q25), beside=TRUE, levels=df$sexe)
table(df$q81, df$sexe)
library(gtsummary)
df |> tbl_summary(c("sexe","q25","q12","q81"))
library(gtsummary)
df |> tbl_summary(include = c("sexe","q25","q12","q81"))
library(gtsummary)
df |> tbl_summary(include = c("sexe","q25","q12","q81"))
library(gtsummary)
df |> tbl_summary(include = c("sexe","q25","q12","q81"))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
fig.width = 6, fig.height = 4, fig.align='center')
bivarie <- function(df, var1, var2, all=TRUE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, var1, var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(projet, sexe, q25, all="table")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE,
fig.width = 6, fig.height = 4, fig.align='center')
library(readxl)
projet = read_xlsx("..//Donnees//Base_Projet.xlsx")
class(projet)
str(projet)
dim(projet)
sum(is.na(projet$key))
projet = projet|>expss::apply_labels(
q1 = "Région",
q2 = "Département",
q23 = "Sexe du dirigeant/responsable de la PME",
q24 = "Age du dirigeant/responsable de la PME",
q24a_1 = "français", q24a_2 = "wolof",q24a_3 = "Diola",
q24a_4 = "Serere", q24a_5 = "Peul",
q24a_6 = "Mandingue", q24a_7 = "Balante",
q24a_9 = "Bambara", q24a_10 = "Autres langues",
q25 = "Niveau d’instruction",
q26 = "Nombre d’années d’experience professionnelle dans l’entreprise",
q12 = "Statut juridique",
q14b = "Autorisation de fabrication et de mise en vente (FRA)",
q16 = "L’entreprise est-elle désservie par une route bitumée ?",
q17 = "Etat de la route bitumée",
q19 = "Etat de la piste qui mène à l’entreprise",
q20 = "Avez-vous des associés dans l’entreprise",filiere_1 = "arachide",
filiere_2 = "anacarde", filiere_3 = "mangue", filiere_4 = "riz",
q8 = "Activité principale", q81 = "Propriétaire ou locataire",
gps_menlatitude = "Latitude", gps_menlongitude = "Longitude",
start = "Date de début de l'enregistrement", today = "Date de l'enquête")
library(dplyr)
projet = projet |> rename(region = q1,
departement = q2,
sexe = q23)
projet = projet |> mutate(sexe_2 = case_when(sexe == "Femme" ~ 1,
sexe != "Femme" ~ 0))
as.factor(projet$sexe_2)
dplyr::recode_factor(projet$sexe_2,
'1' = "Femme", '0' = "Homme")
# table(projet$sexe_2)
langues = data.frame(projet |>
select("key"), projet |> select(starts_with("q24a_")))
langues = langues |> mutate(parle =
rowSums(select(langues, starts_with("q24a_"))))
langues = langues |> select("key","parle")
# Exportation de la base langues
expss::xl_write_file(langues, "..//Sorties//langues.xlsx")
df = inner_join(x=projet,y=langues, join_by(x$key==y$key))
expss::xl_write_file(df, "..//Sorties//nv_projet.xlsx")
plot3 = barplot(table(df$q25), col=c("#BA088A","#08B4BA","#F6BF6D","#E7DDFF"),
main="Niveau d'instruction", cex.names = 0.75)
dev.copy(png, "..//Sorties//plot3.png")
univarie(projet, q24, all="table")
# Sauvegarde de l'image avec ggsave()
ggsave(filename = "plot2.png", plot = plot2, path = "..//Sorties//")
plot5 = ggplot(data.frame(round(proportions((table(df$q81)))*100, 2)),
aes(x = "", y = Freq, fill = Var1)) +
geom_bar(stat="identity", width=1) + ggtitle("Répartition des PME") +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = paste0(Var1," (",Freq,"%)")),
color="white", position = position_stack(vjust=0.5)) +
theme_void() + theme(legend.position = "none")
plot5
ggsave(filename = "plot5.png", plot = plot5, path = "..//Sorties//")
library(gtsummary)
tabs = df |> tbl_summary(include = c("sexe","q25","q12","q81"))
tabs
expss::xl_write_file(tabs, "..//Sorties//Tableaux.xlsx")
library(GGally)
plot8 = ggtable(data=df,
columnsX = "q81",
columnsY = "sexe",
cells = "row.prop")
plot8
ggsave(filename = "plot8.png", plot = plot8, path = "..//Sorties//")
univarie <- function(data, var, all=TRUE, type=""){
library(gtsummary)
library(ggplot2)
attach(data)
## Variable qualitative
if (is.character(var)==TRUE){
df = data.frame(table(var))
names(df) = c("var","eff")
table = data.frame(var) |> tbl_summary()
plot1 = ggplot(df,
aes(x = "", y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
coord_polar(theta = "y", start = 0) +
geom_text(aes(label = eff),color="white",
position = position_stack(vjust=0.5))+
theme_void()
plot2 = ggplot(df,
aes(x = var, y = eff, fill = var)) +
geom_bar(stat = "identity", width=1) +
theme(legend.position = "none")
}
## Variable discrète
else if (is.numeric(var)==TRUE){
table = as.data.frame(summary(data.frame(var)))['Freq']
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot1)}
else if(all=="table"){res = table}
else if(all=="plot"){
if(type=="bar"){res = plot2}
else{res = plot1}
}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
univarie(projet, sexe, all=TRUE)[[1]];univarie(projet, sexe, all=TRUE)[[2]]
univarie(projet, region, all="table")
univarie(projet, q25, all="plot", type="bar")
univarie(projet, q24, all="table")
bivarie <- function(df, var1, var2, all=TRUE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, var1, var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(projet, sexe, q25, all="table")
bivarie(projet, sexe, q25, all="plot")
bivarie <- function(df, var1, var2, all=TRUE){
library(gtsummary)
library(ggplot2)
attach(df)
## Variable qualitative
if (is.character(var1)==TRUE){
df_plot = data.frame(table(var1, var2))
names(df_plot) = c("Var1","Var2","Freq")
plot = ggplot(df_plot,
aes(x = Var1, y = Freq, fill = Var2)) +
geom_bar(stat = "identity", position = "fill")
table = tbl_cross(df, df$var1, df$var2)
}
## Sorties : graphiques ou tableaux
if (all==TRUE){res = list(table,plot)}
else if(all=="table"){res = table}
else if(all=="plot"){res = plot}
else {res = print("Choisir l'option table ou plot")}
return(res)
}
bivarie(projet, sexe, q25, all="plot")
dev.copy(png, "..//Sorties//plot3.png")
plot3 = barplot(table(df$q25), col=c("#BA088A","#08B4BA","#F6BF6D","#E7DDFF"),
main="Niveau d'instruction", cex.names = 0.75)
dev.copy(png, "..//Sorties//plot3.png")
dev.copy(pdf, "..//Sorties//plot3.pdf")
dev.copy(jpeg, "..//Sorties//plot3.jpeg")
library(forcats)
shiny::runApp('app')
